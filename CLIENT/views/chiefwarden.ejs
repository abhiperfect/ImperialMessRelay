<%- include("partials/header.ejs") %>


  <div class=" indexContainer min-vh-100 pt-5">

    <div class="chiefwarden-container">


      <div class="chiefwarden-container-left">



        <%var i=0; Allpost.forEach((item)=> { %>

          <div class="feed-post">
            <div class="feed-post-user-detail">
              <img src="<%= item.postedby.profilephoto %>" class="feed-post-profile-photo" alt="Profile-Photo">
              <div class="feed-post-user-name-date-main">
                <div class="feed-post-user-name-date">
                  <div class="feed-post-user-name">
                    <%= item.postedby.name%>
                  </div>
                  <div class="feed-post-access">
                    <%= item.postedby.hostel %>
                  </div>
                </div>
                <div class="feed-post-user-date">7/11/2023</div>
              </div>
            </div>
            <div class="feed-post-discription">
              <div class="feed-post-discription-title text-primary">#<%= item.title %>
              </div>
              <%= item.body %>
            </div>
            <div class="feed-post-user-image-container"><img src="<%= item.photo %>" alt=""
                class="feed-post-user-image">
            </div>
            <div class="feed-post-body-vote-access-comment">
              <div class="feed-post-body-vote-access">
                <div class="feed-post-body-vote-access-comment-post-vote">





                  <div class="three-state-toggle" id="<% item.id %>">
                    <input type="radio" id="toggle-button-1" name="toggle-button" value="on" checked>
                    <label for="toggle-button-1">Solved</label>

                    <input type="radio" id="toggle-button-2" name="toggle-button" value="off">
                    <label for="toggle-button-2">Unsolved</label>

                    <input type="radio" id="toggle-button-3" name="toggle-button" value="indeterminate">
                    <label for="toggle-button-3">Under Review</label>
                  </div>



                  

                </div>
                <div class="feed-post-body-vote-access-comment-access">
                  <%= item.access %>
                    <%= item.status %>
                </div>
              </div>



              <div class="all-comment-pop-up">

                <!-- POP UP FOR READING COMMENTS     -->
                <!-- Trigger/Open The Modal -->

                <button class="all-comment-pop-up-button" onclick="displayCommentModel('#<% item.id %>')">View all 24
                  comments</button>


                <!-- The Modal -->
                <div id="<% item.id %>" class="all-comment-pop-up-button-modal">
                  <span class="close">&times;</span>
                  <!-- Modal content -->



                  <div class="all-comment-pop-up-button-modal-content">

                    <div class="feed-post-user-detail">
                      <img src="/images/profile.jpg" class="feed-post-profile-photo" alt="Profile-Photo">
                      <div class="feed-post-user-name-date-main">
                        <div class="feed-post-user-name-date">
                          <div class="feed-post-user-name">Raju Rastogi .</div>
                          <div class="feed-post-access">Raman</div>
                        </div>
                        <div class="feed-post-user-date">7/11/2023</div>
                      </div>
                    </div>
                    <div class="feed-post-discription">
                      <p class="feed-post-discription-para"> </p>
                    </div>
                    <div class="feed-post-user-image-container"><img src="/images/food.jpg" alt=""
                        class="feed-post-user-image">

                      <div class="all-comment-pop-up-button-modal-content-comments">

                        <div class="all-comment-pop-up-button-modal-content-comment-user-detail">
                          <img src="/images/profile-1.jpg"
                            class="all-comment-pop-up-button-modal-feed-post-profile-photo" alt="Profile-Photo">
                          <div class="feed-post-user-name-date-main">
                            <div class="feed-post-user-name-date">
                              <div class="all-comment-pop-up-button-modal-user-name-name">Ishant kumar .</div>
                              <div
                                class="all-comment-pop-up-button-modal-user-name all-comment-pop-up-button-modal-user-name-access">
                                Tagore</div>
                            </div>
                            <div class="all-comment-pop-up-button-modal-user-date">7/11/2023</div>
                          </div>

                        </div>
                        <div class="all-comment-pop-up-button-modal-content-comment-text">
                          <p>
                            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Obcaecati rerum officia vitae quae
                            omnis minus veniam esse voluptates excepturi explicabo, dicta cum repudiandae maiores minima
                            numquam corporis natus. Eos, saepe.
                          </p>
                        </div>

                      </div>
                    </div>


                  </div>


                </div>

              </div>
            </div>
          </div>
          <% }) %>
      </div>

      <div class="chiefwarden-container-right">

        <div class="row">
          <div class="col-lg-12">
            <div class="main-box clearfix">
              <div class="table-responsive">
                <table class="table user-list">
                  <thead>
                    <div class="heading-of-user-detail" style="position: fixed;">
                      <tr>
                        <th> <span style="font-weight: bolder; font-size: x-large;">User</span></th>
                        <th><span style="font-weight: bolder; font-size: x-large;">Posts</span></th>
                        <th class="text-center"><span style="font-weight: bolder; font-size: x-large;">Hostel</span>
                        </th>
                        <th><span style="font-weight: bolder; font-size: x-large;">Email</span></th>
                        <th>&nbsp;</th>
                      </tr>
                    </div>


                  </thead>
                  <%var j=0; Alluser.forEach((item)=> { %>
                    <tbody>

                      <%var count=0; %>
                        <% for( i=0; i < Allpost.length; ++i){ %>
                          <% if( Allpost[i].postedby._id==item.id){ %>
                            <% count++; %>
                              <% }%>
                                <% }%>

                                  <tr>
                                    <td>
                                      <img src="<%= item.profilephoto %>" alt="">
                                      <a href="#" class="user-link">
                                        <%= item.name %>
                                      </a>
                                      <span class="user-Hostel">
                                        <%= item.hostel %>
                                      </span>
                                    </td>
                                    <td>
                                      <div class="user-total-post" style="text-align: center;">
                                        <%= count %>
                                      </div>
                                    </td>
                                    <td class="text-center">
                                      <span class="label label-default">
                                        <%= item.hostel %>
                                      </span>
                                    </td>
                                    <td>
                                      <a href="#">
                                        <%= item.email%>
                                      </a>
                                    </td>
                                    <td style="width: 20%; text-align: center;">


                                      <% if( item.state==="blocked" ){ %>
                                        <input type="checkbox" id="myCheckbox<%= item.id %>" data-toggle="switchbutton"
                                          data-onlabel="UN-BLOCK" data-offlabel="ðŸš« Block" data-onstyle="success"
                                          data-offstyle="danger" name="myCheckbox" value="<%= item.id %>"
                                          onchange="sendCheckboxState(this)">
                                        <% } else {%>
                                          <input type="checkbox" id="myCheckbox<%= item.id %>" data-toggle="switchbutton"
                                            checked data-onlabel="UN-BLOCK" data-offlabel="ðŸš« Block"
                                            data-onstyle="success" data-offstyle="danger" name="myCheckbox" value="<%= item.id %>"
                                            onchange="sendCheckboxState(this)">
                                          <% } %>

                                            <script>

                                              function sendCheckboxState( stateid) { 
                                                alert(stateid.value);
                                                const checkbox = document.getElementById(`myCheckbox${ stateid.value}`);
                                                const checkboxState = checkbox.checked ? 1 : 0;
                                                alert(`myCheckbox${ stateid.value}`);
                                                const xhr = new XMLHttpRequest();
                                                xhr.open('post', '/state');
                                                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                                                xhr.send('checkboxState=' + checkboxState);

                                                xhr.onload = function () {
                                                  if (xhr.status === 200) {
                                                    console.log('Checkbox state sent to server:', xhr.responseText);
                                                  } else {
                                                    console.error('Error sending checkbox state to server:', xhr.statusText);
                                                  }
                                                };
                                              }

                                            </script>


                                    </td>
                                  </tr>


                    </tbody>
                    <% }) %>
                </table>
              </div>

            </div>
          </div>
        </div>


      </div>


    </div>



  </div>
  <%- include("partials/footer.ejs") %>